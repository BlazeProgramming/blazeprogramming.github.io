<!DOCTYPE HTML>
<html>
  <head>
    <title>Geometry Dash Unrated Demonlist</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:200,400,600,700" rel="stylesheet">
    <link href="css/stylesheet.css" type="text/css" rel="stylesheet">
  </head>
  <body>
    <script type='text/javascript' src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">
      const list = [
        {
          name: 'Death Corridor',
          author: 'KaotikJumper',
          id: 'n/a',
          hacked: true,
          percentToQualify: 46,
          desc: 'n/a',
          verificationVid: null,
          vids: [
            {
              user: 'Sunix',
              percent: 100,
              link: 'www.youtube.com/watch?v=9799msdH394&t=144s'
            },
            {
              user: 'NoctaFly',
              percent: 100,
              link: 'www.youtube.com/watch?v=kUxKBqsPZr8'
            },
            {
              user: 'EndLevel',
              percent: 63,
              link: 'www.youtube.com/watch?v=5ovINuFEH-U'
            },
            {
              user: 'Beany',
              percent: 50,
              link: 'www.youtube.com/watch?v=f0u8KIxhTzI'
            }
          ]
        },
        {
          name: 'Athanasia',
          author: 'ViRuZ and GD Foxy',
          id: 'n/a',
          hacked: false,
          percentToQualify: 50,
          desc: `This isn't actually the real description. This is just a fake one to test out the formatting. If you were to put in an actual description here, it would fit nicely.`,
          verificationVid: 'https://www.youtube.com/watch?v=xNSfe7cqA0Q&t=68s',
          vids: [
            {
              user: 'Antares',
              percent: 100,
              link: 'www.youtube.com/watch?v=b1_y56OlX4E'
            },
            {
              user: 'GD Foxy',
              percent: 51,
              link: 'www.youtube.com/watch?v=GlMEHiujKl0'
            }
          ]
        }
      ];
    </script>
    <header id="dl-header">
      <div id="sitename"><strong>Un</strong>rated <strong>Demon</strong>list</div>
      <div id="pc-link"><a href="http://pointercrate.com/demonlist/1/"><strong>Pointer</strong>crate <strong>Demon</strong>list</a></div>
    </header>
    <div id="list">
    </div>
    <div id="info">
      <div id="inner-info">
        <div id="levelname"></div>
        <div id="levelauthor">by <em id="inside-level-author"></em></div>
        <br>
        <div id="leveldescription"></div>
        <div id="levelvid"></div>
        <hr>
        <div id="records">
          <div id="records-title">Records</div>
          <div id="qualification"><strong id="levelqualify"></strong>% to qualify.</div>
          <br>
          <div id="records-table">
          </div>
        </div>
      </div>
    </div>
    <div id="additional-information"></div>
    <script name="postload" type="text/javascript">
      var list_node = $("#list");
      var record_node = $("#records-table")
      for(var i = 0; i < list.length; i++){
        var entry = list[i];
        $("<div>").addClass(i === 0 ? 'entry selected' : 'entry').html(`#${i+1}: <strong>${entry.name}</strong> by <em class="author">${entry.author}</em>`).attr('value', i).appendTo(list_node)
      }
      // handlers
      var load = function(node){
        var num;
        if(typeof node == 'number'){
          num = node;
        }else{
          num = $(node).attr('value')
        }

        var entry = list[num];
        if(!entry.hacked){
          entry.verificationVid = entry.verificationVid
            .replace(/www\.youtube.com\/watch\?v=/gi, '')
            .replace(/&t=\d+s/gi, '')
            .replace(/https:\/\//gi, '')
        }
        console.log(entry.verificationVid)
        $("#levelname").text(entry.name);
        $("#inside-level-author").text(entry.author);
        $("#leveldescription").text(entry.desc);
        $("#levelvid").empty();
        if(!entry.hacked){
          $("#levelvid").html(`<hr><iframe id="vid" src="https://www.youtube.com/embed/${entry.verificationVid}?rel=0" frameborder="0" allowfullscreen></iframe>`);
        }
        $("#levelqualify").text(entry.percentToQualify);

        $(record_node).empty();
        for(var j = 0; j < entry.vids.length; j++){
          var record = entry.vids[j];
          if(!record.link.includes('https://')){
            record.link = "https://" + record.link;
          }
          $("<div>").addClass('record-entry').html(`<div class='interentry'><a href="${record.link}"><strong>${record.user}</strong> (<em>${record.percent}%</em>)</div>`).appendTo(record_node)
        }
      };
      $('.entry').click(function(){
        $('.entry').removeClass('selected')
        $(this).addClass('selected');
        load(this);
      })

      load(0)
    </script>
  </body>
</html>
